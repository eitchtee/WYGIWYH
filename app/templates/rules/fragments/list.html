{% load i18n %}
<div class="container px-md-3 py-3 column-gap-5">
  <div class="text-3xl font-bold font-mono w-full mb-3">
    {% spaceless %}
      <div>{% translate 'Rules' %}<span>
      <a class="no-underline text-2xl p-1 category-action"
         role="button"
         data-bs-toggle="tooltip"
         data-bs-title="{% translate "Add" %}"
         hx-get="{% url 'transaction_rule_add' %}"
         hx-target="#generic-offcanvas">
            <i class="fa-solid fa-circle-plus fa-fw"></i></a>
    </span></div>
    {% endspaceless %}
  </div>

  <div class="card bg-base-100 shadow-xl">
    <div class="card-body overflow-x-auto">
      {% if transaction_rules %}
        <c-config.search></c-config.search>
        <table class="table table-hover">
          <thead>
          <tr>
            <th scope="col" class="w-auto"></th>
            <th scope="col" class="w-auto"></th>
            <th scope="col" class="w-auto">{% translate 'Order' %}</th>
            <th scope="col">{% translate 'Name' %}</th>
          </tr>
          </thead>
          <tbody>
          {% for rule in transaction_rules %}
            <tr class="transaction_rule">
              <td class="w-auto">
                <div class="join" role="group" aria-label="{% translate 'Actions' %}">
                  <a class="btn btn-secondary btn-sm join-item"
                     role="button"
                     data-bs-toggle="tooltip"
                     data-bs-title="{% translate "View" %}"
                     hx-get="{% url 'transaction_rule_view' transaction_rule_id=rule.id %}"
                     hx-target="#persistent-generic-offcanvas-left">
                    <i class="fa-solid fa-eye fa-fw"></i></a>
                  <a class="btn btn-secondary btn-sm join-item text-error"
                     role="button"
                     data-bs-toggle="tooltip"
                     data-bs-title="{% translate "Delete" %}"
                     hx-delete="{% url 'transaction_rule_delete' transaction_rule_id=rule.id %}"
                     hx-trigger='confirmed'
                     data-bypass-on-ctrl="true"
                     data-title="{% translate "Are you sure?" %}"
                     data-text="{% translate "You won't be able to revert this!" %}"
                     data-confirm-text="{% translate "Yes, delete it!" %}"
                     _="install prompt_swal"><i class="fa-solid fa-trash fa-fw"></i></a>
                  {% if not rule.owner %}
                    <a class="btn btn-secondary btn-sm join-item text-warning"
                       role="button"
                       data-bs-toggle="tooltip"
                       data-bs-title="{% translate "Take ownership" %}"
                       hx-get="{% url 'transaction_rule_take_ownership' transaction_rule_id=rule.id %}">
                      <i class="fa-solid fa-crown fa-fw"></i></a>
                  {% endif %}
                  {% if user == rule.owner %}
                    <a class="btn btn-secondary btn-sm join-item text-primary"
                       role="button"
                       hx-target="#generic-offcanvas"
                       hx-swap="innerHTML"
                       data-bs-toggle="tooltip"
                       data-bs-title="{% translate "Share" %}"
                       hx-get="{% url 'transaction_rule_share_settings' pk=rule.id %}">
                      <i class="fa-solid fa-share fa-fw"></i></a>
                  {% endif %}
                </div>
              </td>
              <td class="w-auto">
                <a class="no-underline"
                   role="button"
                   data-bs-toggle="tooltip"
                   data-bs-title="
                       {% if rule.active %}{% translate "Deactivate" %}{% else %}{% translate "Activate" %}{% endif %}"
                   hx-get="{% url 'transaction_rule_toggle_activity' transaction_rule_id=rule.id %}">
                  {% if rule.active %}<i class="fa-solid fa-toggle-on text-green-400"></i>{% else %}
                    <i class="fa-solid fa-toggle-off text-red-400"></i>{% endif %}
                </a>
              </td>
              <td class="text-center">
                <div>{{ rule.order }}</div>
              </td>
              <td>
                <div>{{ rule.name }}</div>
                <div class="text-gray-400">{{ rule.description }}</div>
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      {% else %}
        <c-msg.empty title="{% translate "No rules" %}" remove-padding></c-msg.empty>
      {% endif %}
    </div>
  </div>
</div>
